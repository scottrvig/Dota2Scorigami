extends layout

block content

  div(class='table-container')
    - var row = 0;
    - var col = 0;
    table(id='scorigami-matrix-table')
      tbody
        tr 
         th
         while col < maxScore
           th(class='col-header')= col++
        while row < maxScore
          tr(class='table-row')
            -col = 0;
            th(class='col-header')= row
            while col < maxScore
             td(class='col-value', id='cell_' + row + "_" + col++)
            -row++

  script.
      var maxScore = '!{maxScore}';

      $(document).ready(function(){
        $.ajax({
              url: "/getScorigamiMatrix",
              type: "get",
              contentType: "application/json",
              success: function(result) {
                for (var row = 0; row < maxScore; row++) {
                    for (var col = 0; col < maxScore; col++) {
                        var value = result[row][col];
                        if (value <= 0) continue;

                        // Set color gradient
                        if (value == 1) {
                            $("#cell_" + row + "_" + col).addClass("gradient-1");
                        }
                        
                        if (value > 1 && value <= 4) {
                            $("#cell_" + row + "_" + col).addClass("gradient-2");
                        }

                        if (value > 4 && value <= 8) {
                            $("#cell_" + row + "_" + col).addClass("gradient-3");
                        }

                        if (value > 8 && value <= 13) {
                            $("#cell_" + row + "_" + col).addClass("gradient-4");
                        }

                        if (value > 13 && value <= 20) {
                            $("#cell_" + row + "_" + col).addClass("gradient-5");
                        }

                        if (value > 20) {
                            $("#cell_" + row + "_" + col).addClass("gradient-6");
                        }

                        $("#cell_" + row + "_" + col).html(result[row][col]);
                    }
                }
              },
              error: function(result) {
                console.log("Error when trying to load Scorigami matrix.");
              }
        });
      });
extends layout

block content

  div(class='table-container')
    - var row = 0;
    - var col = 0;
    table(id='scorigami-matrix-table')
      tbody
        tr
          td(class='radiantAxisLabel', id='vAxisLabel', rowspan=maxScore+2)
            div(class='vertical')= 'Radiant Score'
          td(class='direAxisLabel', id='hAxisLabel', colspan=maxScore+1)
            div= 'Dire Score'
        tr 
         th
         while col < maxScore
           th(class='header-cell')
             div(class='header-hover', id='colheader_' + col)= col++
        while row < maxScore
          tr(class='table-row')
            -col = 0;
            th(class='header-cell')
              div(class='header-hover', id='rowheader_' + row)= row
            while col < maxScore
             td(class='value-cell', id='cell_' + row + "_" + col++)
                div(class='hover', id='hover_' + row + "_" + (col - 1))
            -row++

  script.
      var maxScore = '!{maxScore}';

      $(document).ready(function(){
        addGridHoverEvents();

        $.ajax({
              url: "/getScorigamiMatrix",
              type: "get",
              contentType: "application/json",
              success: function(result) {
                for (var row = 0; row < maxScore; row++) {
                    for (var col = 0; col < maxScore; col++) {
                        var value = result[row][col];
                        if (value <= 0) continue;

                        // Set color gradient
                        if (value == 1) {
                            $("#cell_" + row + "_" + col).addClass("gradient-1");
                        }
                        
                        if (value > 1 && value <= 4) {
                            $("#cell_" + row + "_" + col).addClass("gradient-2");
                        }

                        if (value > 4 && value <= 8) {
                            $("#cell_" + row + "_" + col).addClass("gradient-3");
                        }

                        if (value > 8 && value <= 13) {
                            $("#cell_" + row + "_" + col).addClass("gradient-4");
                        }

                        if (value > 13 && value <= 20) {
                            $("#cell_" + row + "_" + col).addClass("gradient-5");
                        }

                        if (value > 20) {
                            $("#cell_" + row + "_" + col).addClass("gradient-6");
                        }

                        $("#hover_" + row + "_" + col).html(result[row][col]);
                    }
                }
              },
              error: function(result) {
                console.log("Error when trying to load Scorigami matrix.");
              }
        });
      });